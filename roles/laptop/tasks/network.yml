---
- name: enable networkd
  service: name=systemd-networkd
   enabled=yes
   state=started

- name: enable sshd
  service: name=sshd.socket
    enabled=yes
    state=started

- name: configure wired network adapter
  template: src=wired.network
    dest=/etc/systemd/network/wired.network
  notify: restart network

- name: check resolv.conf
  stat: path=/etc/resolv.conf
  register: resolvconf

- name: delete resolv.conf if not a link
  file: path=/etc/resolv.conf
    state=absent
  when: resolvconf.stat.islink is defined and resolvconf.stat.islnk == False

- name: link systemd to resolv.conf
  file: src=/run/systemd/resolve/resolv.conf
    dest=/etc/resolv.conf
    state=link
